<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>English-Spanish Vocabulary Practice</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 90%;
            margin: 0 auto;
            padding: 1rem;
            background-color: #f5f5f5;
            color: #333;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Cpath d='M30 10 L33 25 L30 40 L27 25 Z' fill='%2378c26d'/%3E%3Cpath d='M30 10 C28 10 26 12 26 14 C26 16 28 18 30 18 C32 18 34 16 34 14 C34 12 32 10 30 10 Z' fill='%2378c26d'/%3E%3Cpath d='M26 22 L22 22 L24 26 L26 26 Z' fill='%2378c26d'/%3E%3Cpath d='M34 30 L38 30 L36 34 L34 34 Z' fill='%2378c26d'/%3E%3Cpath d='M24 36 L20 36 L22 40 L24 40 Z' fill='%2378c26d'/%3E%3C/svg%3E");
            background-repeat: repeat;
            background-position: center;
            position: relative;
        }
        
        @media (min-width: 768px) {
            body {
                max-width: 800px;
                padding: 20px;
            }
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 3px solid #78c26d;
            position: relative;
            width: 100%;
            box-sizing: border-box;
        }
        
        @media (min-width: 768px) {
            .container {
                padding: 30px;
            }
        }
        .container::before, .container::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 60px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 80'%3E%3Cpath d='M25 5 L28 20 L25 35 L22 20 Z' fill='%2378c26d'/%3E%3Cpath d='M25 5 C23 5 21 7 21 9 C21 11 23 13 25 13 C27 13 29 11 29 9 C29 7 27 5 25 5 Z' fill='%2378c26d'/%3E%3Cpath d='M21 17 L17 17 L19 21 L21 21 Z' fill='%2378c26d'/%3E%3Cpath d='M29 25 L33 25 L31 29 L29 29 Z' fill='%2378c26d'/%3E%3Cpath d='M19 31 L15 31 L17 35 L19 35 Z' fill='%2378c26d'/%3E%3Cpath d='M25 35 L25 40 C25 42 27 45 25 50 C23 45 25 42 25 40 Z' fill='%23a67c52'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
        }
        .container::before {
            top: -40px;
            left: 20px;
        }
        .container::after {
            top: -40px;
            right: 20px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .question-container {
            margin-bottom: 30px;
            text-align: center;
        }
        .word {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #3498db;
            word-wrap: break-word;
        }
        
        @media (min-width: 768px) {
            .word {
                font-size: 24px;
                margin-bottom: 20px;
            }
        }
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            width: 100%;
        }
        .option {
            padding: 12px;
            background-color: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            text-align: center;
            word-wrap: break-word;
        }
        
        @media (min-width: 768px) {
            .option {
                padding: 15px;
                font-size: 18px;
            }
        }
        .option:hover {
            background-color: #e9ecef;
        }
        .option.correct {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .option.incorrect {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .feedback {
            margin-top: 20px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            min-height: 27px;
        }
        .next-btn {
            display: block;
            margin: 15px auto 0;
            padding: 8px 15px;
            background-color: #78c26d;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            padding-left: 30px;
        }
        
        @media (min-width: 768px) {
            .next-btn {
                margin: 20px auto 0;
                padding: 10px 20px;
                font-size: 16px;
                padding-left: 35px;
            }
        }
        .next-btn:before {
            content: '';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath d='M10 2 L11 8 L10 14 L9 8 Z' fill='%23ffffff'/%3E%3Cpath d='M7 6 L5 6 L6 8 L7 8 Z' fill='%23ffffff'/%3E%3Cpath d='M13 10 L15 10 L14 12 L13 12 Z' fill='%23ffffff'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
        }
        .next-btn:hover {
            background-color: #5da152;
            transform: scale(1.05);
        }
        .score {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            position: relative;
            display: inline-block;
            padding: 5px 15px;
            background-color: #f8f9fa;
            border-radius: 20px;
            border: 2px dashed #78c26d;
            left: 50%;
            transform: translateX(-50%);
        }
        .score:before, .score:after {
            content: '';
            position: absolute;
            width: 15px;
            height: 25px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 25'%3E%3Cpath d='M7.5 2 L8.5 8 L7.5 14 L6.5 8 Z' fill='%2378c26d'/%3E%3Cpath d='M5 6 L3 6 L4 8 L5 8 Z' fill='%2378c26d'/%3E%3Cpath d='M10 10 L12 10 L11 12 L10 12 Z' fill='%2378c26d'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            top: -15px;
        }
        .score:before {
            left: 10px;
        }
        .score:after {
            right: 10px;
        }
        .language-indicator {
            text-align: center;
            margin-bottom: 10px;
            font-style: italic;
            color: #6c757d;
        }
        .streak-container {
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .streak-count {
            background-color: #78c26d;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
        }
        .points-container {
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .points-count {
            background-color: #3498db;
            color: white;
            border-radius: 5px;
            padding: 5px 10px;
            font-weight: bold;
        }
        .store-button {
            background-color: #f39c12;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: rgba(0,0,0,0); /* Remove tap highlight on mobile */
            position: relative;
            z-index: 10; /* Ensure button is above other elements */
            user-select: none; /* Prevent text selection */
        }
        
        @media (max-width: 767px) {
            .store-button {
                padding: 10px 20px; /* Larger touch target on mobile */
                font-size: 16px; /* Larger text on mobile */
                margin-left: 5px;
            }
        }
        .store-button:hover {
            background-color: #e67e22;
            transform: scale(1.05);
        }
        .mode-button {
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: rgba(0,0,0,0);
            position: relative;
            z-index: 10;
            user-select: none;
            margin-left: 5px;
        }
        
        @media (max-width: 767px) {
            .mode-button {
                padding: 10px 20px;
                font-size: 16px;
                margin-top: 10px;
                width: 100%;
            }
        }
        .mode-button:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS devices */
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 15px;
            border: 3px solid #78c26d;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            max-height: 80vh; /* Limit height on mobile */
            overflow-y: auto; /* Allow scrolling within modal */
        }
        
        @media (min-width: 768px) {
            .modal-content {
                margin: 15% auto;
                padding: 20px;
                width: 80%;
            }
        }
        
        @media (max-width: 767px) {
            .modal-content {
                margin: 10% auto;
                padding: 15px 10px;
                width: 95%;
                max-height: 85vh;
            }
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover {
            color: black;
        }
        .store-item {
            display: flex;
            flex-direction: column;
            padding: 15px;
            margin: 15px 0;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        @media (min-width: 768px) {
            .store-item {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 10px;
                margin: 10px 0;
            }
        }
        .store-item-info {
            flex-grow: 1;
            margin-bottom: 10px;
            text-align: center;
        }
        .store-item-name {
            font-weight: bold;
            font-size: 16px;
            color: #2c3e50;
        }
        .store-item-description {
            color: #6c757d;
            font-size: 14px;
        }
        .store-item-price {
            background-color: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
            margin-bottom: 10px;
            display: inline-block;
        }
        
        @media (min-width: 768px) {
            .store-item-info {
                margin-bottom: 0;
                text-align: left;
            }
            .store-item-name {
                font-size: 18px;
            }
            .store-item-price {
                margin-right: 10px;
                margin-bottom: 0;
            }
        }
        .buy-button {
            background-color: #78c26d;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: rgba(0,0,0,0); /* Remove tap highlight on mobile */
            user-select: none; /* Prevent text selection */
        }
        .buy-button:hover {
            background-color: #5da152;
        }
        .buy-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        @media (max-width: 767px) {
            .buy-button {
                padding: 12px 20px; /* Larger touch target on mobile */
                font-size: 16px; /* Larger text on mobile */
                margin-top: 10px;
                width: 100%; /* Full width on mobile */
            }
        }
        
        /* Pets display styles */
        .pets-container {
            position: fixed;
            right: 10px;
            top: auto;
            bottom: 10px;
            transform: none;
            display: flex;
            flex-direction: row;
            gap: 10px;
            z-index: 10;
        }
        
        .pet {
            width: 45px;
            height: 45px;
            background-color: white;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            border: 2px solid #78c26d;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        @media (min-width: 768px) {
            .pets-container {
                right: 20px;
                top: 50%;
                bottom: auto;
                transform: translateY(-50%);
                flex-direction: column;
                gap: 15px;
            }
            
            .pet {
                width: 60px;
                height: 60px;
            }
        }
        
        .pet.active {
            animation: bounce 2s infinite ease-in-out;
            border: 3px solid #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
        }
        
        .pet:not(.active) {
            opacity: 0.6;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Category selector styles */
        .category-container {
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .category-selector {
            padding: 8px 15px;
            border: 2px solid #78c26d;
            border-radius: 5px;
            background-color: white;
            color: #333;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-selector:hover {
            border-color: #5da152;
        }
        
        @media (max-width: 767px) {
            .category-selector {
                padding: 10px 15px;
                font-size: 16px;
                width: 100%;
                max-width: 200px;
            }
        }
        
        .pet-cactus {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'%3E%3Cpath d='M25 5 L28 20 L25 35 L22 20 Z' fill='%2378c26d'/%3E%3Cpath d='M25 5 C23 5 21 7 21 9 C21 11 23 13 25 13 C27 13 29 11 29 9 C29 7 27 5 25 5 Z' fill='%2378c26d'/%3E%3Cpath d='M21 17 L17 17 L19 21 L21 21 Z' fill='%2378c26d'/%3E%3Cpath d='M29 25 L33 25 L31 29 L29 29 Z' fill='%2378c26d'/%3E%3Cpath d='M19 31 L15 31 L17 35 L19 35 Z' fill='%2378c26d'/%3E%3Cpath d='M25 35 L25 40 C25 42 27 45 25 50 C23 45 25 42 25 40 Z' fill='%23a67c52'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            background-size: 80%;
        }
        
        .pet-dog {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'%3E%3Cellipse cx='25' cy='30' rx='15' ry='12' fill='%23a67c52'/%3E%3Ccircle cx='25' cy='18' r='10' fill='%23a67c52'/%3E%3Ccircle cx='20' cy='15' r='2' fill='%23333'/%3E%3Ccircle cx='30' cy='15' r='2' fill='%23333'/%3E%3Cellipse cx='25' cy='20' rx='4' ry='2' fill='%23333'/%3E%3Cpath d='M15 12 L10 5 L12 12' fill='%23a67c52'/%3E%3Cpath d='M35 12 L40 5 L38 12' fill='%23a67c52'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            background-size: 80%;
        }
        
        .pet-duck {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'%3E%3Cellipse cx='25' cy='30' rx='15' ry='12' fill='%23f5f5dc'/%3E%3Ccircle cx='25' cy='18' r='10' fill='%23f5f5dc'/%3E%3Ccircle cx='22' cy='15' r='2' fill='%23333'/%3E%3Cpath d='M28 15 L35 12 L28 18' fill='%23f39c12'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            background-size: 80%;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Category selector styles */
        .category-container {
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .category-selector {
            padding: 8px 15px;
            border: 2px solid #78c26d;
            border-radius: 5px;
            background-color: white;
            color: #333;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-selector:hover {
            border-color: #5da152;
        }
        
        @media (max-width: 767px) {
            .category-selector {
                padding: 10px 15px;
                font-size: 16px;
                width: 100%;
                max-width: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- Pets container for displaying purchased pets -->
    <div class="pets-container" id="pets-container"></div>
    
    <div class="container">
        <h1>English-Spanish Vocabulary Practice</h1>
        
        <div class="question-container">
            <div class="language-indicator" id="language-indicator">Question in English</div>
            <div class="word" id="word">Loading...</div>
            
            <div class="options-container" id="options-container">
                <!-- Options will be inserted here by JavaScript -->
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <button class="next-btn" id="next-btn">Next Word</button>
        </div>
        
        <div class="score" id="score">Score: 0/0</div>
        <div class="streak-container">
            <span>Daily Streak:</span>
            <div class="streak-count" id="streak-count">0</div>
        </div>
        <div class="points-container">
            <span>Points:</span>
            <div class="points-count" id="points-count">0</div>
            <button class="store-button" id="store-button">Store</button>
            <button class="mode-button" id="mode-button">Regular Mode</button>
        </div>
        
        <!-- Category Selection -->
        <div class="category-container">
            <span>Category:</span>
            <select id="category-selector" class="category-selector">
                <!-- Categories will be populated by JavaScript -->
            </select>
        </div>
        
        <!-- Store Modal -->
        <div id="store-modal" class="modal">
            <div class="modal-content">
                <span class="close-button" id="close-store">&times;</span>
                <h2>Points Store</h2>
                <p>Use your points to purchase items:</p>
                <div id="store-items">
                    <!-- Store items will be added here by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Irregular verbs data is now included directly in this file -->
    <script>
        // Vocabulary data with English and Spanish pairs organized by categories
        // Define categories for vocabulary words
        const categories = [
            { id: 'all', name: 'All Words' },
            { id: 'common', name: 'Common Phrases' },
            { id: 'travel', name: 'Travel & Directions' },
            { id: 'daily', name: 'Daily Life' }
        ];
        
        // Track active category
        let activeCategory = 'all';
        
        const vocabulary = [
            {
                english: "To give a hand",
                spanish: "Dar un golpe de mano",
                category: "common"
            },
            {
                english: "If I were you",
                spanish: "Si yo fuera tu",
                category: "common"
            },
            {
                english: "Come as a surprise",
                spanish: "Ha sido una sorpresa",
                category: "common"
            },
            {
                english: "Had better",
                spanish: "Más vale",
                category: "common"
            },
            {
                english: "Get rid of",
                spanish: "Deshacerse de",
                category: "daily"
            },
            {
                english: "Hear",
                spanish: "Oír",
                category: "daily"
            },
            {
                english: "Listen",
                spanish: "Escuchar",
                category: "daily"
            },
            {
                english: "Pretty",
                spanish: "Bonito",
                category: "common"
            },
            {
                english: "In a row",
                spanish: "En fila",
                category: "common"
            },
            {
                english: "Comes from",
                spanish: "Proviene de",
                category: "common"
            },
            {
                english: "Booth",
                spanish: "Cabina",
                category: "daily"
            },
            {
                english: "Faid",
                spanish: "Desvanecido",
                category: "common"
            },
            {
                english: "Useful",
                spanish: "Útil",
                category: "common"
            },
            {
                english: "Go to",
                spanish: "Ir a",
                category: "travel"
            },
            {
                english: "Away",
                spanish: "Lejos",
                category: "travel"
            },
            {
                english: "Hazard",
                spanish: "Peligro",
                category: "common"
            },
            {
                english: "Choking",
                spanish: "Asfixia",
                category: "daily"
            },
            {
                english: "Railing",
                spanish: "Barandilla",
                category: "daily"
            },
            {
                english: "Sightseeing",
                spanish: "Turismo",
                category: "travel"
            },
            {
                english: "Backyard",
                spanish: "Patio trasero",
                category: "daily"
            },
            {
                english: "Belongings",
                spanish: "Pertenencias"
            },
            {
                english: "Blind",
                spanish: "Ciego"
            },
            {
                english: "Features",
                spanish: "Características"
            },
            {
                english: "Ivory",
                spanish: "Marfil"
            },
            {
                english: "Tusks",
                spanish: "Colmillos"
            },
            {
                english: "Grasp",
                spanish: "Comprender"
            },
            {
                english: "In order to",
                spanish: "Para"
            },
            {
                english: "In fact",
                spanish: "De hecho"
            },
            {
                english: "Put to use",
                spanish: "Poner en uso"
            },
            {
                english: "Take care",
                spanish: "Tener cuidado"
            },
            {
                english: "To get rid of",
                spanish: "Deshacerse de"
            },
            {
                english: "Have to go at",
                spanish: "Tener que ir a"
            },
            {
                english: "Settle",
                spanish: "Establecerse"
            },
            {
                english: "Deep",
                spanish: "Profundo"
            },
            {
                english: "Wide",
                spanish: "Ancho"
            },
            {
                english: "Great",
                spanish: "Genial"
            },
            {
                english: "Been",
                spanish: "Estado"
            },
            {
                english: "Suits",
                spanish: "Trajes"
            },
            {
                english: "Commute",
                spanish: "Desplazamiento"
            },
            {
                english: "Against",
                spanish: "Contra"
            },
            {
                english: "Slippers",
                spanish: "Zapatillas"
            },
            {
                english: "Current",
                spanish: "Actual"
            },
            {
                english: "Fall down",
                spanish: "Caerse"
            },
            {
                english: "When it comes to",
                spanish: "Cuando se trata de"
            },
            {
                english: "Break down",
                spanish: "Descomponer"           },
            {
                english: "Cut down",
                spanish: "Reducir"
            },
            {
                english: "Wandering",
                spanish: "Vagando"
            },
            {
                english: "Avoid",
                spanish: "Evitar"
            },
            {
                english: "Crowds",
                spanish: "Multitudes"
            },
            {
                english: "Spare",
                spanish: "De repuesto"
            },
            {
                english: "Forget",
                spanish: "Olvidar"
            },
            {
                english: "Suitable",
                spanish: "Adecuado"
            },
            {
                english: "Relative",
                spanish: "Pariente"
            },
            {
                english: "Even though",
                spanish: "Aunque"
            },
            {
                english: "Despite",
                spanish: "A pesar de"
            },
            {
                english: "No matter",
                spanish: "No importa"
            },
            {
                english: "Thought",
                spanish: "Pensamiento"
            },
            {
                english: "Far",
                spanish: "Lejos"
            },
            {
                english: "Enough",
                spanish: "Suficiente"
            },
            {
                english: "Wallet",
                spanish: "Cartera"
            },
            {
                english: "Loan",
                spanish: "Préstamo"
            },
            {
                english: "Borrow",
                spanish: "Pedir prestado"
            },
            {
                english: "Withdraws",
                spanish: "Retira"
            },
            {
                english: "Afford",
                spanish: "Permitirse"
            },
            {
                english: "Meal",
                spanish: "Comida"
            },
            {
                english: "Unless",
                spanish: "A menos que"
            },
            {
                english: "As soon as",
                spanish: "Tan pronto como"
            },
            {
                english: "Enrolling",
                spanish: "Inscribirse"
            },
            {
                english: "Relieved",
                spanish: "Aliviado"
            },
            {
                english: "Handed in",
                spanish: "Entregado"
            },
            {
                english: "Rude",
                spanish: "Grosero"
            },
            {
                english: "Behaviour",
                spanish: "Comportamiento"
            },
            {
                english: "Abroad",
                spanish: "En el extranjero"
            },
            {
                english: "Disappointing",
                spanish: "Decepcionante"
            },
            {
                english: "In order to",
                spanish: "Para"
            },
            {
                english: "So that",
                spanish: "Para que"
            },
            {
                english: "Still",
                spanish: "Todavía"
            },
            {
                english: "Chilly",
                spanish: "Frío"
            },
            {
                english: "Nevertheless",
                spanish: "Sin embargo"
            },
            {
                english: "Because of",
                spanish: "Debido a"
            },
            {
                english: "While",
                spanish: "Mientras"
            },
            {
                english: "Whereas",
                spanish: "Mientras que"
            },
            {
                english: "Survey",
                spanish: "Encuesta"
            },
            {
                english: "Support",
                spanish: "Apoyo"
            },
            {
                english: "Near",
                spanish: "Cerca"
            },
            {
                english: "Rather than",
                spanish: "En lugar de"
            },
            {
                english: "Straight face",
                spanish: "Cara seria"
            },
            {
                english: "Pub",
                spanish: "Disco"
            },
            {
                english: "Slight",
                spanish: "Lo mas minimo"
            },
            {
                english: "Reliable",
                spanish: "Confiable"
            },
            {
                english: "Cheap",
                spanish: "Barato"
            },
            {
                english: "Complain",
                spanish: "Quejarse"
            },
            {
                english: "Handsome",
                spanish: "Guapo"
            },
            {
                english: "Wealthy",
                spanish: "Adinerado"
            },
            {
                english: "Wist",
                spanish: "Saber"
            },
            {
                english: "Every",
                spanish: "Cada"
            },
            {
                english: "Whole",
                spanish: "Entero"
            },
            {
                english: "Ill",
                spanish: "Enfermo"
            },
            {
                english: "Childhood",
                spanish: "Infancia"
            },
            {
                english: "Get along",
                spanish: "Llevarse bien"
            },
            {
                english: "Work out",
                spanish: "Resolver"
            },
            {
                english: "Who",
                spanish: "Quién"
            },
            {
                english: "What",
                spanish: "Qué"
            },
            {
                english: "When",
                spanish: "Cuándo"
            },
            {
                english: "Where",
                spanish: "Dónde"
            },
            {
                english: "How",
                spanish: "Cómo"
            },
            {
                english: "Which",
                spanish: "Cuál"
            },
            {
                english: "Attend",
                spanish: "Asistir"
            },
            {
                english: "Assist",
                spanish: "Ayudar"
            },
            {
                english: "Roof",
                spanish: "Techo"
            },
            {
                english: "Both",
                spanish: "Ambos"
            },
            {
                english: "Neither",
                spanish: "Ninguno"
            },
            {
                english: "Either",
                spanish: "Cualquiera"
            },
            {
                english: "Fade",
                spanish: "Desvanecer"
            },
            {
                english: "Melts",
                spanish: "Derrite"
            },
            {
                english: "A play",
                spanish: "Una obra"
            },
            {
                english: "Broadcast",
                spanish: "Transmisión"
            },
            {
                english: "Often",
                spanish: "A menudo"
            },
            {
                english: "Hardly ever",
                spanish: "Casi nunca"
            },
            {
                english: "Ningu",
                spanish: "Ninguno"
            },
            {
                english: "Wallet",
                spanish: "Cartera"
            },
            {
                english: "Some",
                spanish: "Algunos"
            },
            {
                english: "Any",
                spanish: "Cualquier"
            },
            {
                english: "Amazed",
                spanish: "Asombrado"
            },
            {
                english: "Amazing",
                spanish: "Asombroso"
            },
            {
                english: "Tired",
                spanish: "Cansado"
            },
            {
                english: "Tiring",
                spanish: "Agotador"
            },
            {
                english: "Annoyed",
                spanish: "Molesto"
            },
            {
                english: "Chase",
                spanish: "Perseguir"
            },
            {
                english: "Embarrassed",
                spanish: "Avergonzado"
            },
            {
                english: "Resigned",
                spanish: "Resignado"
            },
            {
                english: "Ast board",
                spanish: "Tablero"
            },
            {
                english: "Astonishing",
                spanish: "Sorprendente"
            },
            {
                english: "Help yourselfs",
                spanish: "Sírvanse"
            },
            {
                english: "Each other",
                spanish: "El uno al otro"
            },
            {
                english: "By myself",
                spanish: "Por mí mismo"
            },
            {
                english: "One another",
                spanish: "Unos a otros"
            },
            {
                english: "Can",
                spanish: "Poder"
            },
            {
                english: "Handle",
                spanish: "Manejar"
            },
            {
                english: "Blizzard",
                spanish: "Ventisca"
            },
            {
                english: "Foggy",
                spanish: "Brumoso"
            },
            {
                english: "Forecast",
                spanish: "Pronóstico"
            },
            {
                english: "Sights",
                spanish: "Lugares de interés"
            },
            {
                english: "Leading",
                spanish: "Líder"
            },
            {
                english: "Regarded",
                spanish: "Considerado"
            },
            {
                english: "Like",
                spanish: "Como"
            },
            {
                english: "As",
                spanish: "Como"
            },
            {
                english: "Box",
                spanish: "Caja"
            },
            {
                english: "It is no wonder",
                spanish: "No es de extrañar"
            },
            {
                english: "Advertisement",
                spanish: "Anuncio"
            },
            {
                english: "Brand",
                spanish: "Marca"
            },
            {
                english: "Fee",
                spanish: "Tarifa"
            },
            {
                english: "Waste",
                spanish: "Desperdicio"
            },
            {
                english: "Washing",
                spanish: "Lavado"
            },
            {
                english: "Coach",
                spanish: "Entrenador"
            },
            {
                english: "Journey",
                spanish: "Viaje"
            },
            {
                english: "Book",
                spanish: "Reservar"
            },
            {
                english: "Reach",
                spanish: "Alcanzar"
            },
            {
                english: "Schedule",
                spanish: "Horario"
            },
            {
                english: "Ease",
                spanish: "Facilidad"
            },
            {
                english: "Outcomes",
                spanish: "Resultados"
            },
            {
                english: "Nowadays",
                spanish: "Hoy en día"
            },
            {
                english: "Although",
                spanish: "Aunque"
            },
            {
                english: "For",
                spanish: "Para"
            },
            {
                english: "Since",
                spanish: "Desde"
            },
            {
                english: "Busy",
                spanish: "Ocupado"
            },
            {
                english: "Basement",
                spanish: "Sótano"
            },
            {
                english: "As...as",
                spanish: "Tan...como"
            },
            {
                english: "Assignment",
                spanish: "Tarea"
            },
            {
                english: "In spite of",
                spanish: "A pesar de"
            },
            {
                english: "However",
                spanish: "Sin embargo"
            },
            {
                english: "Gathered",
                spanish: "Reunido"
            },
            {
                english: "Headlines",
                spanish: "Titulares"
            },
            {
                english: "Highway",
                spanish: "Autopista"
            },
            {
                english: "Huge",
                spanish: "Enorme"
            },
            {
                english: "Showed up",
                spanish: "Apareció"
            },
            {
                english: "Set up",
                spanish: "Establecer"
            },
            {
                english: "Put up",
                spanish: "Poner"
            },
            {
                english: "Show me up",
                spanish: "Avergonzarme"
            },
            {
                english: "Set out",
                spanish: "Emprender"
            },
            {
                english: "Rang up",
                spanish: "Llamó por teléfono"
            },
            {
                english: "Put out",
                spanish: "Apagar"
            },
            {
                english: "Set off",
                spanish: "Partir"
            },
            {
                english: "Ran out",
                spanish: "Se acabó"
            },
            {
                english: "Wear out",
                spanish: "Desgastar"
            },
            {
                english: "Wrapped up",
                spanish: "Terminado"
            },
            {
                english: "Turn up",
                spanish: "Aparecer"
            },
            {
                english: "Turn into",
                spanish: "Convertirse en"
            },
            {
                english: "Sign up",
                spanish: "Inscribirse"
            },
            {
                english: "Back of",
                spanish: "Parte trasera"
            },
            {
                english: "Apologise",
                spanish: "Disculparse"
            },
            {
                english: "Ties",
                spanish: "Corbatas"
            },
            {
                english: "Browsed",
                spanish: "Navegado"
            },
            {
                english: "Search engine",
                spanish: "Motor de búsqueda"
            },
            {
                english: "Reliable",
                spanish: "Confiable"
            },
            {
                english: "Cutting",
                spanish: "Cortante"
            },
            {
                english: "Up to date",
                spanish: "Actualizado"
            },
            {
                english: "Afraid",
                spanish: "Asustado"
            },
            {
                english: "Fright",
                spanish: "Susto"
            },
            {
                english: "Overcome",
                spanish: "Superar"
            },
            {
                english: "Spook",
                spanish: "Asustar"
            },
            {
                english: "Fear",
                spanish: "Miedo"
            },
            {
                english: "Lift",
                spanish: "Levantar"
            },
            {
                english: "Out of order",
                spanish: "Fuera de servicio"
            },
            {
                english: "To look forward to",
                spanish: "Esperar con ilusión"
            },
            {
                english: "Such as",
                spanish: "Tales como"
            },
            {
                english: "Hoaxes",
                spanish: "Engaños"
            },
            {
                english: "Made up",
                spanish: "Inventado"
            },
            {
                english: "Mermaids",
                spanish: "Sirenas"
            },
            {
                english: "Despite",
                spanish: "A pesar de"
            },
            {
                english: "Dismissed",
                spanish: "Descartado"
            },
            {
                english: "Muggy",
                spanish: "Bochornoso"
            },
            {
                english: "Hazy",
                spanish: "Brumoso"
            },
            {
                english: "Scorching",
                spanish: "Abrasador"
            },
            {
                english: "Mild",
                spanish: "Suave"
            },
            {
                english: "Damp",
                spanish: "Húmedo"
            },
            {
                english: "If I were you",
                spanish: "Si yo fuera tú"
            },
            {
                english: "Nippy",
                spanish: "Fresco"
            },
            {
                english: "Overcast",
                spanish: "Nublado"
            },
            {
                english: "Misty",
                spanish: "Brumoso"
            }
        ];

        // DOM elements
        const wordElement = document.getElementById('word');
        const optionsContainer = document.getElementById('options-container');
        const feedbackElement = document.getElementById('feedback');
        const nextButton = document.getElementById('next-btn');
        const scoreElement = document.getElementById('score');
        const languageIndicator = document.getElementById('language-indicator');

        // Irregular verbs data with three forms: base, past, and participle (all in English)
        const irregularVerbs = [
            { base: "Arise", past: "Arose", participle: "Arisen" },
            { base: "Be", past: "Was/Were", participle: "Been" },
            { base: "Bear", past: "Bore", participle: "Born/Borne" },
            { base: "Beat", past: "Beat", participle: "Beaten" },
            { base: "Become", past: "Became", participle: "Become" },
            { base: "Begin", past: "Began", participle: "Begun" },
            { base: "Bend", past: "Bent", participle: "Bent" },
            { base: "Bet", past: "Bet", participle: "Bet" },
            { base: "Bite", past: "Bit", participle: "Bitten" },
            { base: "Blow", past: "Blew", participle: "Blown" },
            { base: "Break", past: "Broke", participle: "Broken" },
            { base: "Bring", past: "Brought", participle: "Brought" },
            { base: "Build", past: "Built", participle: "Built" },
            { base: "Buy", past: "Bought", participle: "Bought" },
            { base: "Catch", past: "Caught", participle: "Caught" },
            { base: "Choose", past: "Chose", participle: "Chosen" },
            { base: "Come", past: "Came", participle: "Come" },
            { base: "Cost", past: "Cost", participle: "Cost" },
            { base: "Cut", past: "Cut", participle: "Cut" },
            { base: "Do", past: "Did", participle: "Done" },
            { base: "Draw", past: "Drew", participle: "Drawn" },
            { base: "Drink", past: "Drank", participle: "Drunk" },
            { base: "Drive", past: "Drove", participle: "Driven" },
            { base: "Eat", past: "Ate", participle: "Eaten" },
            { base: "Fall", past: "Fell", participle: "Fallen" },
            { base: "Feed", past: "Fed", participle: "Fed" },
            { base: "Feel", past: "Felt", participle: "Felt" },
            { base: "Fight", past: "Fought", participle: "Fought" },
            { base: "Find", past: "Found", participle: "Found" },
            { base: "Fly", past: "Flew", participle: "Flown" },
            { base: "Forget", past: "Forgot", participle: "Forgotten" },
            { base: "Forgive", past: "Forgave", participle: "Forgiven" },
            { base: "Freeze", past: "Froze", participle: "Frozen" },
            { base: "Get", past: "Got", participle: "Got/Gotten" },
            { base: "Give", past: "Gave", participle: "Given" },
            { base: "Go", past: "Went", participle: "Gone" },
            { base: "Grow", past: "Grew", participle: "Grown" },
            { base: "Hang", past: "Hung", participle: "Hung" },
            { base: "Have", past: "Had", participle: "Had" },
            { base: "Hear", past: "Heard", participle: "Heard" },
            { base: "Hide", past: "Hid", participle: "Hidden" },
            { base: "Hit", past: "Hit", participle: "Hit" },
            { base: "Hold", past: "Held", participle: "Held" },
            { base: "Hurt", past: "Hurt", participle: "Hurt" },
            { base: "Keep", past: "Kept", participle: "Kept" },
            { base: "Know", past: "Knew", participle: "Known" },
            { base: "Lay", past: "Laid", participle: "Laid" },
            { base: "Lead", past: "Led", participle: "Led" },
            { base: "Leave", past: "Left", participle: "Left" },
            { base: "Lend", past: "Lent", participle: "Lent" },
            { base: "Let", past: "Let", participle: "Let" },
            { base: "Lie", past: "Lay", participle: "Lain" },
            { base: "Light", past: "Lit", participle: "Lit" },
            { base: "Lose", past: "Lost", participle: "Lost" },
            { base: "Make", past: "Made", participle: "Made" },
            { base: "Mean", past: "Meant", participle: "Meant" },
            { base: "Meet", past: "Met", participle: "Met" },
            { base: "Pay", past: "Paid", participle: "Paid" },
            { base: "Put", past: "Put", participle: "Put" },
            { base: "Read", past: "Read", participle: "Read" },
            { base: "Ride", past: "Rode", participle: "Ridden" },
            { base: "Ring", past: "Rang", participle: "Rung" },
            { base: "Rise", past: "Rose", participle: "Risen" },
            { base: "Run", past: "Ran", participle: "Run" },
            { base: "Say", past: "Said", participle: "Said" },
            { base: "See", past: "Saw", participle: "Seen" },
            { base: "Sell", past: "Sold", participle: "Sold" },
            { base: "Send", past: "Sent", participle: "Sent" },
            { base: "Set", past: "Set", participle: "Set" },
            { base: "Shake", past: "Shook", participle: "Shaken" },
            { base: "Shine", past: "Shone", participle: "Shone" },
            { base: "Shoot", past: "Shot", participle: "Shot" },
            { base: "Show", past: "Showed", participle: "Shown" },
            { base: "Sing", past: "Sang", participle: "Sung" },
            { base: "Sink", past: "Sank", participle: "Sunk" },
            { base: "Sit", past: "Sat", participle: "Sat" },
            { base: "Sleep", past: "Slept", participle: "Slept" },
            { base: "Speak", past: "Spoke", participle: "Spoken" },
            { base: "Spend", past: "Spent", participle: "Spent" },
            { base: "Stand", past: "Stood", participle: "Stood" },
            { base: "Steal", past: "Stole", participle: "Stolen" },
            { base: "Swim", past: "Swam", participle: "Swum" },
            { base: "Take", past: "Took", participle: "Taken" },
            { base: "Teach", past: "Taught", participle: "Taught" },
            { base: "Tear", past: "Tore", participle: "Torn" },
            { base: "Tell", past: "Told", participle: "Told" },
            { base: "Think", past: "Thought", participle: "Thought" },
            { base: "Throw", past: "Threw", participle: "Thrown" },
            { base: "Understand", past: "Understood", participle: "Understood" },
            { base: "Wake", past: "Woke", participle: "Woken" },
            { base: "Wear", past: "Wore", participle: "Worn" },
            { base: "Win", past: "Won", participle: "Won" },
            { base: "Write", past: "Wrote", participle: "Written" }
        ];
        
        // Game state
        let currentWord = null;
        let currentLanguage = null;
        let correctAnswer = null;
        let score = 0;
        let totalQuestions = 0;
        let answered = false;
        let streakCount = 0;
        let lastLoginDate = null;
        let activityCompletedToday = false;
        let points = 0;
        let consecutiveCorrectAnswers = 0; // Track consecutive correct answers for combo bonus
        let activePetId = null; // Track which pet is currently active
        let isIrregularVerbMode = false; // Start with regular vocabulary mode
        
        // Store items
        const storeItems = [
            {
                id: 1,
                name: "Cactus Pet",
                description: "A cute cactus friend that multiplies your points by 2",
                price: 50,
                purchased: false
            },
            {
                id: 2,
                name: "Dog Pet",
                description: "A loyal companion that gives you +6 bonus points",
                price: 100,
                purchased: false
            },
            {
                id: 3,
                name: "Duck Pet",
                description: "A friendly duck that gives you +10 bonus points",
                price: 250,
                purchased: false
            }
        ];

        // Load streak data from localStorage
        function loadStreakData() {
            const streakData = localStorage.getItem('vocabularyStreak');
            if (streakData) {
                const data = JSON.parse(streakData);
                streakCount = data.count || 0;
                lastLoginDate = data.lastLogin ? new Date(data.lastLogin) : null;
                activityCompletedToday = data.activityCompletedToday || false;
            }
            updateStreakDisplay();
        }

        // Save streak data to localStorage
        function saveStreakData() {
            const data = {
                count: streakCount,
                lastLogin: new Date().toISOString(),
                activityCompletedToday: activityCompletedToday
            };
            localStorage.setItem('vocabularyStreak', JSON.stringify(data));
            updateStreakDisplay();
        }
        
        // Load points data from localStorage
        function loadPointsData() {
            const pointsData = localStorage.getItem('vocabularyPoints');
            if (pointsData) {
                const data = JSON.parse(pointsData);
                points = data.points || 0;
                
                // Load purchased items
                if (data.purchasedItems) {
                    data.purchasedItems.forEach(itemId => {
                        const item = storeItems.find(item => item.id === itemId);
                        if (item) {
                            item.purchased = true;
                        }
                    });
                }
            }
            updatePointsDisplay();
        }

        // Save points data to localStorage
        function savePointsData() {
            const purchasedItems = storeItems
                .filter(item => item.purchased)
                .map(item => item.id);
                
            const data = {
                points: points,
                purchasedItems: purchasedItems
            };
            localStorage.setItem('vocabularyPoints', JSON.stringify(data));
            updatePointsDisplay();
        }

        // Update the streak display
        function updateStreakDisplay() {
            document.getElementById('streak-count').textContent = streakCount;
        }
        
        // Update the points display
        function updatePointsDisplay() {
            document.getElementById('points-count').textContent = points;
        }
        
        // Initialize the store
        function initializeStore() {
            const storeItemsContainer = document.getElementById('store-items');
            storeItemsContainer.innerHTML = '';
            
            storeItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'store-item';
                
                const itemInfo = document.createElement('div');
                itemInfo.className = 'store-item-info';
                
                const itemName = document.createElement('div');
                itemName.className = 'store-item-name';
                itemName.textContent = item.name;
                
                const itemDescription = document.createElement('div');
                itemDescription.className = 'store-item-description';
                itemDescription.textContent = item.description;
                
                itemInfo.appendChild(itemName);
                itemInfo.appendChild(itemDescription);
                
                const itemPrice = document.createElement('div');
                itemPrice.className = 'store-item-price';
                itemPrice.textContent = `${item.price} pts`;
                
                const buyButton = document.createElement('button');
                buyButton.className = 'buy-button';
                
                if (item.purchased) {
                    buyButton.textContent = 'Purchased';
                    buyButton.disabled = true;
                } else {
                    buyButton.textContent = 'Buy';
                    buyButton.disabled = points < item.price;
                    buyButton.addEventListener('click', () => purchaseItem(item));
                }
                
                itemElement.appendChild(itemInfo);
                itemElement.appendChild(itemPrice);
                itemElement.appendChild(buyButton);
                
                storeItemsContainer.appendChild(itemElement);
            });
        }
        
        // Purchase an item
        function purchaseItem(item) {
            if (points >= item.price && !item.purchased) {
                points -= item.price;
                item.purchased = true;
                savePointsData();
                initializeStore();
                
                // Show purchase confirmation
                alert(`You have purchased ${item.name}!`);
                
                // Display the pet on the side of the screen
                if (item.name.includes('Pet')) {
                    displayPet(item);
                }
            }
        }
        
        // Display a pet on the side of the screen
        function displayPet(item) {
            const petsContainer = document.getElementById('pets-container');
            
            // Create pet element
            const petElement = document.createElement('div');
            petElement.className = 'pet';
            petElement.dataset.petId = item.id;
            
            // Add specific class based on pet type
            if (item.name.includes('Cactus')) {
                petElement.classList.add('pet-cactus');
            } else if (item.name.includes('Dog')) {
                petElement.classList.add('pet-dog');
            } else if (item.name.includes('Duck')) {
                petElement.classList.add('pet-duck');
            }
            
            // Set active class if this is the active pet
            if (activePetId === item.id) {
                petElement.classList.add('active');
            }
            
            // Add click event to toggle active status
            petElement.addEventListener('click', () => toggleActivePet(item.id));
            
            // Add pet to container
            petsContainer.appendChild(petElement);
        }
        
        // Toggle active pet
        function toggleActivePet(petId) {
            // If clicking the already active pet, deactivate it
            if (activePetId === petId) {
                activePetId = null;
            } else {
                // Otherwise, set this pet as active
                activePetId = petId;
            }
            
            // Save active pet to localStorage
            saveActivePet();
            
            // Update pet display
            updatePetsDisplay();
        }
        
        // Save active pet to localStorage
        function saveActivePet() {
            localStorage.setItem('vocabularyActivePet', activePetId);
        }
        
        // Load active pet from localStorage
        function loadActivePet() {
            const savedActivePet = localStorage.getItem('vocabularyActivePet');
            if (savedActivePet) {
                activePetId = parseInt(savedActivePet);
            }
        }
        
        // Update all pets display to reflect active status
        function updatePetsDisplay() {
            const petElements = document.querySelectorAll('.pet');
            petElements.forEach(pet => {
                const petId = parseInt(pet.dataset.petId);
                if (petId === activePetId) {
                    pet.classList.add('active');
                } else {
                    pet.classList.remove('active');
                }
            });
        }

        // Check and update streak
        function checkStreak() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (!lastLoginDate) {
                // First time user
                lastLoginDate = today;
                saveStreakData();
                return;
            }

            const lastLogin = new Date(lastLoginDate);
            lastLogin.setHours(0, 0, 0, 0);
            
            const timeDiff = today.getTime() - lastLogin.getTime();
            const dayDiff = timeDiff / (1000 * 3600 * 24);

            if (dayDiff === 0) {
                // Same day login, no streak change
                if (!activityCompletedToday) {
                    // User hasn't completed an activity today yet
                    return;
                }
            } else if (dayDiff === 1) {
                // Next day login
                activityCompletedToday = false;
                lastLoginDate = today;
                saveStreakData();
            } else {
                // More than one day has passed, reset streak
                streakCount = 0;
                activityCompletedToday = false;
                lastLoginDate = today;
                saveStreakData();
            }
        }

        // Mark activity as completed for today
        function markActivityCompleted() {
            if (!activityCompletedToday) {
                activityCompletedToday = true;
                streakCount++;
                saveStreakData();
            }
        }

        // Initialize the category selector
        function initializeCategorySelector() {
            const categorySelector = document.getElementById('category-selector');
            categorySelector.innerHTML = '';
            
            // Add all categories to the selector
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                categorySelector.appendChild(option);
            });
            
            // Set the active category
            categorySelector.value = activeCategory;
            
            // Add event listener for category change
            categorySelector.addEventListener('change', function() {
                activeCategory = this.value;
                saveActiveCategory();
                nextWord();
            });
        }
        
        // Save active category to localStorage
        function saveActiveCategory() {
            localStorage.setItem('vocabularyActiveCategory', activeCategory);
        }
        
        // Load active category from localStorage
        function loadActiveCategory() {
            const savedCategory = localStorage.getItem('vocabularyActiveCategory');
            if (savedCategory) {
                activeCategory = savedCategory;
            }
        }
        
        // Initialize the game
        loadStreakData();
        loadPointsData();
        loadActivePet();
        loadActiveCategory();
        checkStreak();
        displayPurchasedPets();
        initializeCategorySelector();
        nextWord();
        
        // Function to toggle between regular vocabulary and irregular verbs mode
        function toggleMode() {
            isIrregularVerbMode = !isIrregularVerbMode;
            const modeButton = document.getElementById('mode-button');
            
            if (isIrregularVerbMode) {
                modeButton.textContent = 'Irregular Verbs Mode';
                modeButton.style.backgroundColor = '#e74c3c';
                // Update title to reflect the irregular verbs mode
                document.title = 'English Irregular Verbs Practice';
            } else {
                modeButton.textContent = 'Regular Mode';
                modeButton.style.backgroundColor = '#3498db';
                // Restore original title
                document.title = 'English-Spanish Vocabulary Practice';
            }
            
            // Load a new word from the appropriate list
            nextWord();
        }
        
        // Add event listener for mode toggle button
        document.getElementById('mode-button').addEventListener('click', toggleMode);
        
        // Display all purchased pets
        function displayPurchasedPets() {
            // Clear pets container first
            const petsContainer = document.getElementById('pets-container');
            petsContainer.innerHTML = '';
            
            // Display all purchased pets
            storeItems.forEach(item => {
                if (item.purchased && item.name.includes('Pet')) {
                    displayPet(item);
                }
            });
            
            // Update pets display to show active status
            updatePetsDisplay();
        }

        // Event listener for the next button
        nextButton.addEventListener('click', nextWord);
        
        // Store modal elements
        const storeModal = document.getElementById('store-modal');
        const storeButton = document.getElementById('store-button');
        const closeStore = document.getElementById('close-store');
        
        // Event listeners for store modal
        storeButton.addEventListener('click', function(e) {
            e.preventDefault(); // Prevent default behavior
            e.stopPropagation(); // Stop event propagation
            initializeStore();
            storeModal.style.display = 'block';
        });
        
        // Add touch event for mobile devices
        storeButton.addEventListener('touchend', function(e) {
            e.preventDefault(); // Prevent default behavior
            e.stopPropagation(); // Stop event propagation
            initializeStore();
            storeModal.style.display = 'block';
        });
        
        closeStore.addEventListener('click', function() {
            storeModal.style.display = 'none';
        });
        
        // Close modal when clicking outside of it
        window.addEventListener('click', function(event) {
            if (event.target === storeModal) {
                storeModal.style.display = 'none';
            }
        });
        
        // Add touch event for closing modal on mobile
        window.addEventListener('touchend', function(event) {
            if (event.target === storeModal) {
                storeModal.style.display = 'none';
            }
        });

        // Function to display the next word
        function nextWord() {
            // Reset state
            feedbackElement.textContent = '';
            optionsContainer.innerHTML = '';
            answered = false;

            // Select the appropriate word list based on mode
            let wordList = isIrregularVerbMode ? irregularVerbs : vocabulary;
            
            // Filter words by category if not in 'all' category and not in irregular verb mode
            if (activeCategory !== 'all' && !isIrregularVerbMode) {
                wordList = vocabulary.filter(word => word.category === activeCategory);
                
                // If no words in this category, fallback to all words
                if (wordList.length === 0) {
                    wordList = vocabulary;
                }
            }
            
            // Randomly select a word from the filtered list
            const randomIndex = Math.floor(Math.random() * wordList.length);
            currentWord = wordList[randomIndex];

            if (isIrregularVerbMode) {
                // For irregular verbs mode, randomly choose which form to show (base, past, or participle)
                const verbForms = ['base', 'past', 'participle'];
                const randomFormIndex = Math.floor(Math.random() * 3);
                const questionForm = verbForms[randomFormIndex];
                
                // Randomly select which form to ask for
                const remainingForms = verbForms.filter(form => form !== questionForm);
                const answerFormIndex = Math.floor(Math.random() * 2);
                const answerForm = remainingForms[answerFormIndex];
                
                // Display the question form
                wordElement.textContent = currentWord[questionForm];
                
                 // Update language indicator to show which verb form is being asked
                languageIndicator.textContent = `Match the time of the irregular verb`;
                
                // Set the correct answer
                correctAnswer = currentWord[answerForm];
                
                // Generate options (including the correct answer and 2 random incorrect answers)
                const options = [correctAnswer];
                
                // Add two random incorrect options from other verbs with the same form
                while (options.length < 3) {
                    const randomVerbIndex = Math.floor(Math.random() * irregularVerbs.length);
                    if (randomVerbIndex !== randomIndex) {
                        const randomOption = irregularVerbs[randomVerbIndex][answerForm];
                        if (!options.includes(randomOption)) {
                            options.push(randomOption);
                        }
                    }
                }
                
                // Shuffle options
                shuffleArray(options);
                
                // Create option elements
                options.forEach(option => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.textContent = option;
                    optionElement.addEventListener('click', () => checkAnswer(option, optionElement));
                    optionsContainer.appendChild(optionElement);
                });
            } else {
                // Regular vocabulary mode (English-Spanish)
                // Randomly decide whether to show English or Spanish
                currentLanguage = Math.random() < 0.5 ? 'english' : 'spanish';
                const oppositeLanguage = currentLanguage === 'english' ? 'spanish' : 'english';

                // Display the word in the selected language
                wordElement.textContent = currentWord[currentLanguage];
                
                // Update language indicator
                languageIndicator.textContent = `Question in ${currentLanguage.charAt(0).toUpperCase() + currentLanguage.slice(1)}`;

                // Set the correct answer
                correctAnswer = currentWord[oppositeLanguage];

                // Generate options (including the correct answer and 2 random incorrect answers)
                const options = [correctAnswer];
                
                // Add two random incorrect options
                while (options.length < 3) {
                    const randomWordIndex = Math.floor(Math.random() * vocabulary.length);
                    if (randomWordIndex !== randomIndex) {
                        const randomOption = vocabulary[randomWordIndex][oppositeLanguage];
                        if (!options.includes(randomOption)) {
                            options.push(randomOption);
                        }
                    }
                }

                // Shuffle options
                shuffleArray(options);

                // Create option elements
                options.forEach(option => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.textContent = option;
                    optionElement.addEventListener('click', () => checkAnswer(option, optionElement));
                    optionsContainer.appendChild(optionElement);
                });
            }
        }

        // Function to check the selected answer
        function checkAnswer(selectedOption, optionElement) {
            if (answered) return;
            
            answered = true;
            totalQuestions++;

            // Check if the answer is correct
            const isCorrect = selectedOption === correctAnswer;
            
            // Update score if correct
            if (isCorrect) {
                score++;
                // Increment consecutive correct answers counter
                consecutiveCorrectAnswers++;
                
                // Award points for correct answer
                let pointsEarned = 2;
                let bonusText = "";
                
                // Add combo bonus point for every 5 consecutive correct answers
                if (consecutiveCorrectAnswers % 5 === 0) {
                    pointsEarned += 1; // Add bonus point for combo
                    bonusText += " (Combo +1 bonus)";
                }
                
                // Check for active pet abilities
                const activePet = storeItems.find(item => item.id === activePetId && item.purchased);
                
                // Apply active pet abilities
                if (activePet) {
                    if (activePet.id === 1) { // Cactus
                        pointsEarned *= 2; // Cactus multiplies points by 2
                        bonusText += " (Cactus x2 bonus)";
                    } else if (activePet.id === 2) { // Dog
                        pointsEarned += 6; // Dog adds 6 points
                        bonusText += " (Dog +6 bonus)";
                    } else if (activePet.id === 3) { // Duck
                        pointsEarned += 10; // Duck adds 10 points
                        bonusText += " (Duck +10 bonus)";
                    }
                }
                
                points += pointsEarned;
                savePointsData();
                
                feedbackElement.textContent = `¡Correcto! / Correct! (+${pointsEarned} points)${bonusText}`;
                optionElement.classList.add('correct');
            } else {
                // Reset consecutive correct answers counter on wrong answer
                consecutiveCorrectAnswers = 0;
                
                feedbackElement.textContent = '¡Incorrecto! / Incorrect!';
                optionElement.classList.add('incorrect');
                
                // Highlight the correct answer
                const options = optionsContainer.querySelectorAll('.option');
                options.forEach(opt => {
                    if (opt.textContent === correctAnswer) {
                        opt.classList.add('correct');
                    }
                });
            }

            // Update score display
            scoreElement.textContent = `Score: ${score}/${totalQuestions}`;
            
            // Mark activity as completed for streak
            markActivityCompleted();
        }

        // Function to shuffle an array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
</body>
</html>